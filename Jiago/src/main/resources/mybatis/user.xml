<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC 
	"-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="com.itbank.repository.UserDAO">


	<select id="login" parameterType="user" resultType="user">
		select * from member where user_id=#{user_id} and user_pw=#{user_pw } and user_withdraw='N'
	</select>




	<insert id="join" parameterType="user">
		insert into member 
		    (user_id, user_pw, user_name, user_birth, user_gender,
		     user_address, user_phone, user_email, user_job, user_type) 
		    values (#{user_id}, #{user_pw}, #{user_name}, #{user_birth},#{user_gender}, #{user_address}, #{user_phone},
		    #{user_email}, #{user_job}, #{user_type})
	</insert>

	<select id="checkRealMail" parameterType="String" resultType="String">
		select user_email from member where user_email=#{email}
	</select>


	<select id="getId" parameterType="String" resultType="String">
		select user_id from member where user_email=#{email}
	</select>

	<select id="checkId" parameterType="String" resultType="HashMap">
		select user_id,user_email,user_phone from member where user_id=#{id}
	</select>

	<update id="update" parameterType="user">
		update member 
			set user_address=#{user_address},
		 	user_phone=#{user_phone},
			user_email=#{user_email},
			user_job=#{user_job}
		 		 where user_idx = #{user_idx}
	</update>
	
	<update id="newPasswordSet" parameterType="user">
		update member set user_pw=#{user_pw} where user_id=#{user_id}
	</update>
	
	<update id="pwUpdate" parameterType="user">
		update member set user_pw=#{user_pw} where user_idx=#{user_idx}
	</update>
	
	<select id="getPoint" parameterType="int" resultType="String">
		select sum(point) from point where user_idx=#{user_idx}
	</select>
	
	<select id="getPw" parameterType="String" resultType="String">
		select user_pw from member where user_idx=#{idx}
	</select>
	
	<!-- 삭제지만 withdraw를 Y로 업데이트 한다  -->
	<update id="quit" parameterType="int">
		update member set 
		user_id = '탈퇴', user_pw = '탈퇴', user_name = '탈퇴', user_birth = '00/01/01', user_gender = '남',
		user_address = '탈퇴', user_phone = '0', user_email = '탈퇴', user_job = '탈퇴', 
		user_type = 'Member', user_joindate = '00/01/01', user_withdraw = 'Y', user_agree = 'Y'
		where user_idx = #{idx }
	</update>

</mapper>
